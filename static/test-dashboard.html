<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test Dashboard</title>
</head>
<body>
    <h1>Test Navigation API</h1>
    <div id="output"></div>
    
    <script>
        async function testAPI() {
            const output = document.getElementById('output');
            try {
                const response = await fetch('/api/navigation');
                const data = await response.json();
                
                output.innerHTML = '<h2>API Response:</h2>';
                output.innerHTML += '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                
                // Test countTotalFiles
                function countTotalFiles(items) {
                    if (!items || !Array.isArray(items)) return 0;
                    
                    let count = 0;
                    items.forEach(item => {
                        if (!item) return;
                        
                        if (item.type === 'folder') {
                            if (item.children && Array.isArray(item.children)) {
                                count += countTotalFiles(item.children);
                            }
                        } else if (item.type === 'file') {
                            count++;
                        }
                    });
                    return count;
                }
                
                const totalFiles = countTotalFiles(data.navigation);
                output.innerHTML += `<h3>Total Files: ${totalFiles}</h3>`;
                
                // Check each folder
                data.navigation.forEach(item => {
                    if (item.type === 'folder') {
                        const fileCount = countTotalFiles([item]);
                        output.innerHTML += `<p>${item.name}: ${fileCount} files</p>`;
                    }
                });
                
            } catch (error) {
                output.innerHTML = '<p style="color: red;">Error: ' + error.message + '</p>';
            }
        }
        
        testAPI();
    </script>
</body>
</html>